CAU 1:
SELECT MANV, TENNV
FROM NHANVIEN
WHERE PHG=4
ORDER BY MANV DESC
CAU 2:
SELECT MANV, TENNV, LUONG
FROM NHANVIEN
WHERE LUONG > 30000
ORDER BY LUONG ASC
CAU 3:
SELECT MANV, TENNV, LUONG ,PHG
FROM NHANVIEN
WHERE (PHG = 4 AND LUONG > 25000) OR (PHG = 5 AND LUONG >30000)
ORDER BY LUONG DESC, PHG ASC
CAU 4:
SELECT CONCAT(HONV,' ',TENLOT,' ',TENNV) AS HOTEN
FROM NHANVIEN NV
JOIN PHONGBAN PB ON PB.MAPHG=NV.PHG
JOIN DIADIEM_PHG DD ON DD.MAPHG=PB.MAPHG
WHERE DD.DIADIEM='TP HCM'
CAU 5:
SELECT CONCAT(HONV,' ',TENLOT,' ',TENNV) AS HOTEN
FROM NHANVIEN NV
WHERE HONV LIKE 'N%'
CAU 6:
SELECT NV.NGSINH, NV.DCHI
FROM NHANVIEN NV
WHERE CONCAT(NV.HONV,' ',NV.TENLOT,' ',NV.TENNV)='Dinh Ba Tien'
CAU 7:
SELECT NV.MANV, CONCAT(NV.HONV,' ',NV.TENLOT,' ',NV.TENNV) AS HOTEN, YEAR(NV.NGSINH) AS NAMSINH
FROM NHANVIEN NV
WHERE YEAR(NGSINH) BETWEEN 1960 AND 1965;
CAU 8:
SELECT NV.MANV, CONCAT(NV.HONV,' ',NV.TENLOT,' ',NV.TENNV) AS HOTEN, YEAR(NV.NGSINH) AS NAMSINH
FROM NHANVIEN NV
CAU 9:
SELECT NV.MANV, CONCAT(NV.HONV,' ',NV.TENLOT,' ',NV.TENNV) AS HOTEN, YEAR(GETDATE())-YEAR(NV.NGSINH) AS SOTUOI
FROM NHANVIEN NV
ORDER BY SOTUOI 
CAU 10:
SELECT PB.TENPHG, DD.DIADIEM
FROM PHONGBAN PB
JOIN DIADIEM_PHG DD ON DD.MAPHG=PB.MAPHG
CAU 11:
SELECT CONCAT(NV.HONV,' ',NV.TENLOT,' ',NV.TENNV) AS HOTEN, PB.TENPHG
FROM NHANVIEN NV
JOIN PHONGBAN PB ON PB.MA_TRPHG=NV.MANV
CAU 12:
SELECT CONCAT(NV.HONV,' ',NV.TENLOT,' ',NV.TENNV) AS HOTEN, NV.DCHI
FROM NHANVIEN NV JOIN PHONGBAN PB ON PB.MAPHG = NV.PHG 
WHERE PB.TENPHG = 'Nghien Cuu'
CAU 13:
SELECT CONCAT(NV.HONV,' ',NV.TENLOT,' ',NV.TENNV) AS TRGPHG, DA.TENDA
FROM NHANVIEN NV 
JOIN PHONGBAN PB ON MA_TRPHG = MANV 
JOIN DIADIEM_PHG DDP ON DDP.MAPHG = PB.MAPHG
JOIN DEAN DA ON DA.PHONG = PB.MAPHG
WHERE DDP.DIADIEM = 'HA NOI'
CAU 14
SELECT CONCAT(NV.HONV,' ',NV.TENLOT,' ',NV.TENNV) AS HOTEN, TN.TEN_TN, TN.QUANHE
FROM NHANVIEN NV 
JOIN THANNHAN TN ON TN.MA_NVIEN = NV.MANV
WHERE NV.PHAI = 'Nu'
CAU 15:
SELECT 
	CONCAT(NV.HONV,' ',NV.TENLOT,' ',NV.TENNV) AS 'HOTEN',
	CONCAT(NVL.HONV,' ',NVL.TENLOT,' ',NVL.TENNV) AS 'TENNQL'
FROM 
    NHANVIEN NV LEFT JOIN NHANVIEN NVL ON NV.MA_NQL = NVL.MANV
CAU 16:
SELECT 
	NV.HONV AS 'Ho nhan vien', TRG_PHG.HONV AS 'Ho truong phong'
FROM NHANVIEN NV 
	LEFT JOIN NHANVIEN TRG_PHG ON TRG_PHG.PHG = NV.PHG
	JOIN PHONGBAN PB ON PB.MA_TRPHG = TRG_PHG.MANV
ORDER BY [Ho truong phong]
CAU 17:
SELECT 
	CONCAT(NV.HONV,' ',NV.TENLOT,' ',NV.TENNV) AS 'HOTEN',
	DA.TENDA
FROM 
    NHANVIEN NV 
	LEFT JOIN NHANVIEN NVL ON NV.MA_NQL = NVL.MANV
	LEFT JOIN DEAN DA ON DA.PHONG = NV.PHG
WHERE DA.TENDA = 'San pham x' AND CONCAT(NVL.HONV,' ',NVL.TENLOT,' ',NVL.TENNV) = 'Nguyen Thanh Tung'
CAU 18:
SELECT DA.TENDA
FROM NHANVIEN NV JOIN DEAN DA ON DA.PHONG = NV.PHG
WHERE CONCAT(NV.HONV,' ',NV.TENLOT,' ',NV.TENNV) = 'Dinh Ba Tien'
CAU 19:
SELECT COUNT(*) AS SO_LUONG
FROM DEAN
CAU 20:
SELECT COUNT(*) AS SO_LUONG
FROM DEAN DA JOIN PHONGBAN PB ON PB.MAPHG = DA.PHONG
WHERE PB.TENPHG = 'Nghien Cuu'
CAU 21:
SELECT AVG(LUONG) AS 'Luong trung binh'
FROM NHANVIEN
WHERE PHAI = 'Nu'
CAU 22:
SELECT COUNT(*)
FROM NHANVIEN NV JOIN THANNHAN TN ON TN.MA_NVIEN = NV.MANV
WHERE CONCAT(NV.HONV,' ',NV.TENLOT,' ',NV.TENNV) = 'Dinh Ba Tien'
CAU 23:
SELECT  DA.TENDA, SUM(PC.THOIGIAN)
FROM DEAN AS DA LEFT JOIN PHANCONG PC ON PC.SODA = DA.MADA
GROUP BY DA.TENDA
CAU 24:
SELECT DA.TENDA, COUNT(*) AS 'SO LUONG THAM GIA'
FROM DEAN DA LEFT JOIN PHANCONG PC ON DA.MADA = PC.SODA
GROUP BY DA.TENDA
CAU 25:
SELECT NV.HONV, NV.TENNV ,COUNT(TN.TEN_TN) AS Sl_THANNHAN
FROM NHANVIEN NV LEFT JOIN THANNHAN TN ON NV.MANV = TN.MA_NVIEN
GROUP BY NV.HONV, NV.TENNV
CAU 26:
SELECT NV.HONV, NV.TENNV, COUNT(PC.MA_NVIEN)
FROM NHANVIEN NV LEFT JOIN PHANCONG PC ON NV.MANV=PC.MA_NVIEN
GROUP BY NV.HONV, NV.TENNV
CAU 27:
SELECT NV_QL.TENNV , COUNT(NV.TENNV) AS SL_NV
FROM NHANVIEN NV_QL JOIN NHANVIEN NV ON NV_QL.MANV = NV.MA_NQL
GROUP BY NV_QL.TENNV
CAU 28:
SELECT PB.TENPHG, AVG(NV.LUONG) AS LUONG_TB
FROM PHONGBAN PB LEFT JOIN NHANVIEN NV ON PB.MAPHG = NV.PHG
GROUP BY PB.TENPHG
CAU 29:
SELECT PB.TENPHG, AVG(NV.LUONG) AS LUONG_TB, COUNT(NV.PHG) AS Sl_NV
FROM PHONGBAN PB LEFT JOIN NHANVIEN NV ON PB.MAPHG = NV.PHG
GROUP BY PB.TENPHG
HAVING AVG(NV.LUONG) > 30000
CAU 30:
SELECT PB.TENPHG, COUNT(PB.TENPHG) AS SL_DA
FROM PHONGBAN PB LEFT JOIN DEAN DA ON DA.PHONG = PB.MAPHG
GROUP BY PB.TENPHG
CAU 31:
SELECT PB.TENPHG, COUNT(DISTINCT DA.MADA) AS SL_DA, AVG(NV.LUONG) AS LUONG_TB
FROM NHANVIEN NV 
	JOIN PHONGBAN PB ON NV.PHG = PB.MAPHG
	JOIN DEAN DA ON PB.MAPHG = DA.PHONG
GROUP BY PB.TENPHG
HAVING AVG(NV.LUONG) > 40000
CAU 32:
SELECT PB.TENPHG, COUNT(DISTINCT DA.MADA) AS SL_DA, AVG(NV.LUONG) AS LUONG_TB
FROM NHANVIEN NV 
	JOIN PHONGBAN PB ON NV.PHG = PB.MAPHG
	JOIN DEAN DA ON PB.MAPHG = DA.PHONG
GROUP BY PB.TENPHG
HAVING AVG(NV.LUONG) > 40000
CAU 33:
SELECT DDIEM_DA, COUNT(TENDA) AS SL_DA
FROM DEAN
GROUP BY DDIEM_DA
CAU 34:
SELECT DA.TENDA, SUM(PC.THOIGIAN) AS TONG_TG
FROM DEAN DA LEFT JOIN PHANCONG PC ON PC.SODA = DA.MADA
GROUP BY DA.TEND
CAU 35:
SELECT COUNT(DA.TENDA) AS SL_NV
FROM DEAN DA JOIN PHANCONG PC ON DA.MADA = PC.SODA AND DA.TENDA = 'Dao tao'
CAU 36:
